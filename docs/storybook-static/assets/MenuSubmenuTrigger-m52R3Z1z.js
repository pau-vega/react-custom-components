var pt=Object.defineProperty;var ft=(e,s,u)=>s in e?pt(e,s,{enumerable:!0,configurable:!0,writable:!0,value:u}):e[s]=u;var Fe=(e,s,u)=>ft(e,typeof s!="symbol"?s+"":s,u);import{r as n}from"./index-Br2IOmUs.js";import{u as le}from"./useStableCallback-CgA2ffE5.js";import{u as De}from"./useControlled-BhWCjR1C.js";import{u as me}from"./useCompositeListItem-2W6IGSyp.js";import{m as xe,u as W}from"./useRenderElement-DBf0zvZM.js";import{u as ge,a as mt}from"./useBaseUiId-Ds3dA0Bv.js";import{j as he,c as ne,o as gt,b as fe,v as ce,m as ht,a as Ue,t as vt,f as bt,l as xt,e as Ct}from"./createBaseUIEventDetails-BfRHIGKf.js";import{j as D}from"./jsx-runtime-D_zvdyIk.js";import{f as J,b as Rt,u as Mt,E as It,a as yt}from"./empty-BwNtW-GQ.js";import{t as Be,u as Ve,a as Ce}from"./useTransitionStatus-H-zITwNf.js";import{k as Ge,m as Pt,q as St,n as Et,T as Tt,t as kt}from"./popupStateMapping-B2J1S55N.js";import{u as wt}from"./ToolbarRootContext-Dqmc35tY.js";import{C as Ot}from"./composite-CCzA221R.js";import{g as Nt,u as At}from"./getDisabledMountTransitionStyles-xn1qLHjW.js";import{a as Ft,u as Ut}from"./useHoverReferenceInteraction-BCD5gqBx.js";import{F as Lt,I as jt,u as Ht}from"./InternalBackdrop-IVVNL8k2.js";import{i as Dt}from"./inertValue-Cg075CKc.js";import{C as Bt}from"./CompositeList-qs3wigw5.js";import{i as Vt,R as Gt,P as _t,f as F,d as Kt,e as Yt,u as qt,l as Wt,b as _e,h as Jt}from"./useInteractions-DLoJm_bm.js";import{r as Xt}from"./index-B1jiiJTD.js";import{u as Le}from"./useTimeout-DEENwbcq.js";import{u as je}from"./useIsoLayoutEffect-B3i3ZXBb.js";import{u as $t}from"./useAnimationFrame-BGZzLPhQ.js";import{u as zt}from"./DirectionContext-DcsIbjZ7.js";import{u as Qt}from"./useOpenInteractionType-DABt_JZJ.js";import{p as Zt,d as en,a as tn,b as nn,c as on,e as sn}from"./useSyncedFloatingRootContext-BHS4UzMP.js";import{u as rn}from"./useRole-BXNmVtjw.js";import{u as an}from"./useListNavigation-B0MKivMs.js";import{u as un}from"./useTypeahead-D1TfG5s2.js";import{a as cn,o as ln,n as dn}from"./floating-ui.utils.dom-BR__G8pa.js";import{u as pn}from"./useButton-D8OkA_9h.js";import{s as fn}from"./safePolygon-B1_E0Dln.js";import{u as mn}from"./useClick-TS9p-E59.js";const gn=n.createContext(void 0);function Re(e=!0){const s=n.useContext(gn);if(s===void 0&&!e)throw new Error(J(25));return s}const Ke=n.createContext(void 0);function de(e){const s=n.useContext(Ke);if(s===void 0&&!e)throw new Error(J(33));return s}const Ye=n.createContext(void 0);function X(e){const s=n.useContext(Ye);if(s===void 0&&!e)throw new Error(J(36));return s}const qe=n.createContext(void 0);function hn(){const e=n.useContext(qe);if(e===void 0)throw new Error(J(30));return e}const Me={type:"regular-item"};function ve(e){const{closeOnClick:s,disabled:u=!1,highlighted:d,id:I,store:b,nativeButton:E,itemMetadata:o,nodeId:c}=e,h=n.useRef(null),m=Re(!0),v=m!==void 0,{events:f}=b.useState("floatingTreeRoot"),{getButtonProps:C,buttonRef:y}=pn({disabled:u,focusableWhenDisabled:!0,native:E}),a=n.useCallback(i=>xe({id:I,role:"menuitem",tabIndex:d?0:-1,onMouseMove(r){c&&f.emit("itemhover",{nodeId:c,target:r.currentTarget})},onMouseEnter(){o.type==="submenu-trigger"&&o.setActive()},onKeyUp(r){r.key===" "&&b.context.typingRef.current&&r.preventBaseUIHandler()},onClick(r){s&&f.emit("close",{domEvent:r,reason:he})},onMouseUp(r){if(m){const N=m.initialCursorPointRef.current;if(m.initialCursorPointRef.current=null,v&&N&&Math.abs(r.clientX-N.x)<=1&&Math.abs(r.clientY-N.y)<=1)return}h.current&&b.context.allowMouseUpTriggerRef.current&&(!v||r.button===2)&&o.type==="regular-item"&&h.current.click()}},i,C),[I,d,C,s,f,b,v,m,o,c]),g=Rt(h,y);return n.useMemo(()=>({getItemProps:a,itemRef:g}),[a,g])}let He=(function(e){return e.checked="data-checked",e.unchecked="data-unchecked",e.disabled="data-disabled",e.highlighted="data-highlighted",e})({});const be={checked(e){return e?{[He.checked]:""}:{[He.unchecked]:""}},...Be},io=n.forwardRef(function(s,u){const{render:d,className:I,id:b,label:E,nativeButton:o=!1,disabled:c=!1,closeOnClick:h=!1,checked:m,defaultChecked:v,onCheckedChange:f,...C}=s,y=me({label:E}),a=de(!0),g=ge(b),{store:i}=X(),r=i.useState("isActive",y.index),N=i.useState("itemProps"),[A,t]=De({controlled:m,default:v??!1,name:"MenuCheckboxItem",state:"checked"}),{getItemProps:U,itemRef:R}=ve({closeOnClick:h,disabled:c,highlighted:r,id:g,store:i,nativeButton:o,nodeId:a==null?void 0:a.nodeId,itemMetadata:Me}),P=n.useMemo(()=>({disabled:c,highlighted:r,checked:A}),[c,r,A]),p=le(T=>{const B={...ne(he,T.nativeEvent),preventUnmountOnClose:()=>{}};f==null||f(!A,B),!B.isCanceled&&t(w=>!w)}),G=W("div",s,{state:P,stateAttributesMapping:be,props:[N,{role:"menuitemcheckbox","aria-checked":A,onClick:p},C,U],ref:[R,u,y.ref]});return D.jsx(qe.Provider,{value:P,children:G})}),uo=n.forwardRef(function(s,u){const{render:d,className:I,keepMounted:b=!1,...E}=s,o=hn(),c=n.useRef(null),{transitionStatus:h,setMounted:m}=Ve(o.checked);Ce({open:o.checked,ref:c,onComplete(){o.checked||m(!1)}});const v=n.useMemo(()=>({checked:o.checked,disabled:o.disabled,highlighted:o.highlighted,transitionStatus:h}),[o.checked,o.disabled,o.highlighted,h]);return W("span",s,{state:v,ref:[u,c],stateAttributesMapping:be,props:{"aria-hidden":!0,...E},enabled:b||o.checked})}),co=n.forwardRef(function(s,u){const{render:d,className:I,id:b,label:E,nativeButton:o=!1,disabled:c=!1,closeOnClick:h=!0,...m}=s,v=me({label:E}),f=de(!0),C=ge(b),{store:y}=X(),a=y.useState("isActive",v.index),g=y.useState("itemProps"),{getItemProps:i,itemRef:r}=ve({closeOnClick:h,disabled:c,highlighted:a,id:C,store:y,nativeButton:o,nodeId:f==null?void 0:f.nodeId,itemMetadata:Me}),N=n.useMemo(()=>({disabled:c,highlighted:a}),[c,a]);return W("div",s,{state:N,props:[g,m,i],ref:[r,u,v.ref]})}),vn={...Ge,...Be},lo=n.forwardRef(function(s,u){const{render:d,className:I,finalFocus:b,...E}=s,{store:o}=X(),{side:c,align:h}=de(),m=wt()!=null,v=o.useState("open"),f=o.useState("transitionStatus"),C=o.useState("popupProps"),y=o.useState("mounted"),a=o.useState("instantType"),g=o.useState("activeTriggerElement"),i=o.useState("parent"),r=o.useState("lastOpenChangeReason"),N=o.useState("rootId"),A=o.useState("floatingRootContext"),t=o.useState("floatingTreeRoot"),U=o.useState("closeDelay"),R=o.useState("activeTriggerElement"),P=i.type==="context-menu";Ce({open:v,ref:o.context.popupRef,onComplete(){var k,V;v&&((V=(k=o.context).onOpenChangeComplete)==null||V.call(k,!0))}}),n.useEffect(()=>{function k(V){o.setOpen(!1,ne(V.reason,V.domEvent))}return t.events.on("close",k),()=>{t.events.off("close",k)}},[t.events,o]);const p=o.useState("hoverEnabled"),G=o.useState("disabled");Ft(A,{enabled:p&&!G&&!P&&i.type!=="menubar",closeDelay:U});const T=n.useMemo(()=>({transitionStatus:f,side:c,align:h,open:v,nested:i.type==="menu",instant:a}),[f,c,h,v,i.type,a]),B=W("div",s,{state:T,ref:[u,o.context.popupRef],stateAttributesMapping:vn,props:[C,{onKeyDown(k){m&&Ot.has(k.key)&&k.stopPropagation()}},Nt(f),E,{"data-rootownerid":N}]});let w=i.type===void 0||P;return(g||i.type==="menubar"&&r!==gt)&&(w=!0),D.jsx(Lt,{context:A,modal:P,disabled:!y,returnFocus:b===void 0?w:b,initialFocus:i.type!=="menu",restoreFocus:!0,externalTree:i.type!=="menubar"?t:void 0,previousFocusableElement:R,nextFocusableElement:i.type===void 0?o.context.triggerFocusTargetRef:void 0,beforeContentFocusGuardRef:i.type===void 0?o.context.beforeContentFocusGuardRef:void 0,children:B})}),We=n.createContext(void 0);function bn(){const e=n.useContext(We);if(e===void 0)throw new Error(J(32));return e}const po=n.forwardRef(function(s,u){const{keepMounted:d=!1,...I}=s,{store:b}=X();return b.useState("mounted")||d?D.jsx(We.Provider,{value:d,children:D.jsx(Pt,{ref:u,...I})}):null}),fo=n.forwardRef(function(s,u){var ue;const{anchor:d,positionMethod:I="absolute",className:b,render:E,side:o,align:c,sideOffset:h=0,alignOffset:m=0,collisionBoundary:v="clipping-ancestors",collisionPadding:f=5,arrowPadding:C=5,sticky:y=!1,disableAnchorTracking:a=!1,collisionAvoidance:g=St,...i}=s,{store:r}=X(),N=bn(),A=Re(!0),t=r.useState("parent"),U=r.useState("floatingRootContext"),R=r.useState("floatingTreeRoot"),P=r.useState("mounted"),p=r.useState("open"),G=r.useState("modal"),T=r.useState("activeTriggerElement"),B=r.useState("lastOpenChangeReason"),w=r.useState("floatingNodeId"),k=r.useState("floatingParentNodeId");let V=d,S=h,Y=m,$=c,oe=g;t.type==="context-menu"&&(V=d??((ue=t.context)==null?void 0:ue.anchor),$=$??"start",!o&&$!=="center"&&(Y=s.alignOffset??2,S=s.sideOffset??-5));let _=o,K=$;t.type==="menu"?(_=_??"inline-end",K=K??"start",oe=s.collisionAvoidance??Et):t.type==="menubar"&&(_=_??"bottom",K=K??"start");const j=t.type==="context-menu",M=At({anchor:V,floatingRootContext:U,positionMethod:A?"fixed":I,mounted:P,side:_,sideOffset:S,align:K,alignOffset:Y,arrowPadding:j?0:C,collisionBoundary:v,collisionPadding:f,sticky:y,nodeId:w,keepMounted:N,disableAnchorTracking:a,collisionAvoidance:oe,shiftCrossAxis:j,externalTree:R}),Z=n.useMemo(()=>{const O={};return p||(O.pointerEvents="none"),{role:"presentation",hidden:!P,style:{...M.positionerStyles,...O}}},[p,P,M.positionerStyles]);n.useEffect(()=>{function O(L){L.open?(L.parentNodeId===w&&r.set("hoverEnabled",!1),L.nodeId!==w&&L.parentNodeId===r.select("floatingParentNodeId")&&r.setOpen(!1,ne(ce))):L.parentNodeId===w&&L.reason!==ce&&r.set("hoverEnabled",!0)}return R.events.on("menuopenchange",O),()=>{R.events.off("menuopenchange",O)}},[r,R.events,w]),n.useEffect(()=>{if(r.select("floatingParentNodeId")==null)return;function O(L){if(L.open||L.nodeId!==r.select("floatingParentNodeId"))return;const pe=L.reason??ce;r.setOpen(!1,ne(pe))}return R.events.on("menuopenchange",O),()=>{R.events.off("menuopenchange",O)}},[R.events,r]),n.useEffect(()=>{function O(L){!p||L.nodeId!==r.select("floatingParentNodeId")||L.target&&T&&T!==L.target&&r.setOpen(!1,ne(ce))}return R.events.on("itemhover",O),()=>{R.events.off("itemhover",O)}},[R.events,p,T,r]),n.useEffect(()=>{const O={open:p,nodeId:w,parentNodeId:k,reason:r.select("lastOpenChangeReason")};R.events.emit("menuopenchange",O)},[R.events,p,r,w,k]);const q=n.useMemo(()=>({open:p,side:M.side,align:M.align,anchorHidden:M.anchorHidden,nested:t.type==="menu"}),[p,M.side,M.align,M.anchorHidden,t.type]),se=n.useMemo(()=>({side:M.side,align:M.align,arrowRef:M.arrowRef,arrowUncentered:M.arrowUncentered,arrowStyles:M.arrowStyles,nodeId:M.context.nodeId}),[M.side,M.align,M.arrowRef,M.arrowUncentered,M.arrowStyles,M.context.nodeId]),ae=W("div",s,{state:q,stateAttributesMapping:Ge,ref:[u,r.useStateSetter("positionerElement")],props:[Z,i]}),ie=P&&t.type!=="menu"&&(t.type!=="menubar"&&G&&B!==fe||t.type==="menubar"&&t.context.modal);let z=null;return t.type==="menubar"?z=t.context.contentElement:t.type===void 0&&(z=T),D.jsxs(Ke.Provider,{value:se,children:[ie&&D.jsx(jt,{ref:t.type==="context-menu"||t.type==="nested-context-menu"?t.context.internalBackdropRef:null,inert:Dt(!p),cutout:z}),D.jsx(Vt,{id:w,children:D.jsx(Bt,{elementsRef:r.context.itemDomElements,labelsRef:r.context.itemLabels,children:ae})})]})}),Je=n.createContext(void 0);function xn(){const e=n.useContext(Je);if(e===void 0)throw new Error(J(34));return e}const mo=n.memo(n.forwardRef(function(s,u){const{render:d,className:I,value:b,defaultValue:E,onValueChange:o,disabled:c=!1,...h}=s,[m,v]=De({controlled:b,default:E,name:"MenuRadioGroup"}),f=le(o),C=le((i,r)=>{f==null||f(i,r),!r.isCanceled&&v(i)}),y=n.useMemo(()=>({disabled:c}),[c]),a=W("div",s,{state:y,ref:u,props:{role:"group","aria-disabled":c||void 0,...h}}),g=n.useMemo(()=>({value:m,setValue:C,disabled:c}),[m,C,c]);return D.jsx(Je.Provider,{value:g,children:a})})),Xe=n.createContext(void 0);function Cn(){const e=n.useContext(Xe);if(e===void 0)throw new Error(J(35));return e}const go=n.forwardRef(function(s,u){const{render:d,className:I,id:b,label:E,nativeButton:o=!1,disabled:c=!1,closeOnClick:h=!1,value:m,...v}=s,f=me({label:E}),C=de(!0),y=ge(b),{store:a}=X(),g=a.useState("isActive",f.index),i=a.useState("itemProps"),{value:r,setValue:N,disabled:A}=xn(),t=A||c,U=r===m,{getItemProps:R,itemRef:P}=ve({closeOnClick:h,disabled:t,highlighted:g,id:y,store:a,nativeButton:o,nodeId:C==null?void 0:C.nodeId,itemMetadata:Me}),p=n.useMemo(()=>({disabled:t,highlighted:g,checked:U}),[t,g,U]),G=le(B=>{const w={...ne(he,B.nativeEvent),preventUnmountOnClose:()=>{}};N(m,w)}),T=W("div",s,{state:p,stateAttributesMapping:be,props:[i,{role:"menuitemradio","aria-checked":U,onClick:G},v,R],ref:[P,u,f.ref]});return D.jsx(Xe.Provider,{value:p,children:T})}),ho=n.forwardRef(function(s,u){const{render:d,className:I,keepMounted:b=!1,...E}=s,o=Cn(),c=n.useRef(null),{transitionStatus:h,setMounted:m}=Ve(o.checked);Ce({open:o.checked,ref:c,onComplete(){o.checked||m(!1)}});const v=n.useMemo(()=>({checked:o.checked,disabled:o.disabled,highlighted:o.highlighted,transitionStatus:h}),[o.checked,o.disabled,o.highlighted,h]);return W("span",s,{state:v,stateAttributesMapping:be,ref:[u,c],props:{"aria-hidden":!0,...E},enabled:b||o.checked})}),Rn=n.createContext(null);function Mn(e){const s=n.useContext(Rn);if(s===null&&!e)throw new Error(J(5));return s}const In={...Zt,disabled:F(e=>e.parent.type==="menubar"&&e.parent.context.disabled||e.disabled),modal:F(e=>(e.parent.type===void 0||e.parent.type==="context-menu")&&(e.modal??!0)),allowMouseEnter:F(e=>e.parent.type==="menu"?e.parent.store.select("allowMouseEnter"):e.allowMouseEnter),stickIfOpen:F(e=>e.stickIfOpen),parent:F(e=>e.parent),rootId:F(e=>e.parent.type==="menu"?e.parent.store.select("rootId"):e.parent.type!==void 0?e.parent.context.rootId:e.rootId),activeIndex:F(e=>e.activeIndex),isActive:F((e,s)=>e.activeIndex===s),hoverEnabled:F(e=>e.hoverEnabled),instantType:F(e=>e.instantType),lastOpenChangeReason:F(e=>e.openChangeReason),floatingTreeRoot:F(e=>e.parent.type==="menu"?e.parent.store.select("floatingTreeRoot"):e.floatingTreeRoot),floatingNodeId:F(e=>e.floatingNodeId),floatingParentNodeId:F(e=>e.floatingParentNodeId),itemProps:F(e=>e.itemProps),closeDelay:F(e=>e.closeDelay),keyboardEventRelay:F(e=>{if(e.keyboardEventRelay)return e.keyboardEventRelay;if(e.parent.type==="menu")return e.parent.store.select("keyboardEventRelay")})};class Ie extends Gt{constructor(u){super({...yn(),...u},{positionerRef:n.createRef(),popupRef:n.createRef(),typingRef:{current:!1},itemDomElements:{current:[]},itemLabels:{current:[]},allowMouseUpTriggerRef:{current:!1},triggerFocusTargetRef:n.createRef(),beforeContentFocusGuardRef:n.createRef(),onOpenChangeComplete:void 0,triggerElements:new _t},In);Fe(this,"unsubscribeParentListener",null);this.observe(F(d=>d.allowMouseEnter),(d,I)=>{this.state.parent.type==="menu"&&d!==I&&this.state.parent.store.set("allowMouseEnter",d)}),this.unsubscribeParentListener=this.observe("parent",d=>{var I;if((I=this.unsubscribeParentListener)==null||I.call(this),d.type==="menu"){this.unsubscribeParentListener=d.store.subscribe(()=>{this.notifyAll()}),this.context.allowMouseUpTriggerRef=d.store.context.allowMouseUpTriggerRef;return}d.type!==void 0&&(this.context.allowMouseUpTriggerRef=d.context.allowMouseUpTriggerRef),this.unsubscribeParentListener=null})}setOpen(u,d){this.state.floatingRootContext.context.events.emit("setOpen",{open:u,eventDetails:d})}static useStore(u,d){const I=Mt(()=>new Ie(d)).current;return u??I}}function yn(){return{...en(),disabled:!1,modal:!0,allowMouseEnter:!0,stickIfOpen:!0,parent:{type:void 0},rootId:void 0,activeIndex:null,hoverEnabled:!0,instantType:void 0,openChangeReason:null,floatingTreeRoot:new Kt,floatingNodeId:void 0,floatingParentNodeId:null,itemProps:It,keyboardEventRelay:void 0,closeDelay:0}}const $e=n.createContext(void 0);function ze(){return n.useContext($e)}function Pn(e){const{children:s,open:u,onOpenChange:d,onOpenChangeComplete:I,defaultOpen:b=!1,disabled:E=!1,modal:o,loopFocus:c=!0,orientation:h="vertical",actionsRef:m,closeParentOnEsc:v=!1,handle:f,triggerId:C,defaultTriggerId:y=null,highlightItemOnHover:a=!0}=e,g=Re(!0),i=X(!0),r=Mn(!0),N=ze(),A=n.useMemo(()=>N&&i?{type:"menu",store:i.store}:r?{type:"menubar",context:r}:g&&!i?{type:"context-menu",context:g}:{type:void 0},[g,i,r,N]),t=Ie.useStore(f==null?void 0:f.store,{parent:A}),U=t.useState("floatingTreeRoot"),R=Yt(U),P=qt();je(()=>{g&&!i?t.update({parent:{type:"context-menu",context:g},floatingNodeId:R,floatingParentNodeId:P}):i&&t.update({floatingNodeId:R,floatingParentNodeId:P})},[g,i,R,P,t]),t.useControlledProp("open",u,b),t.useControlledProp("activeTriggerId",C,y),t.useContextCallback("onOpenChangeComplete",I);const p=t.useState("open"),G=t.useState("activeTriggerElement"),T=t.useState("positionerElement"),B=t.useState("hoverEnabled"),w=t.useState("modal"),k=t.useState("disabled"),V=t.useState("lastOpenChangeReason"),S=t.useState("parent"),Y=t.useState("activeIndex"),$=t.useState("payload"),oe=t.useState("floatingParentNodeId"),_=n.useRef(null),K=oe!=null;let j;t.useSyncedValues({disabled:E,modal:S.type===void 0?o:void 0,rootId:mt()});const{openMethod:M,triggerProps:Z,reset:q}=Qt(p);tn(t);const{forceUnmount:se}=nn(p,t,()=>{t.update({allowMouseEnter:!1,stickIfOpen:!0}),q()}),ae=n.useRef(S.type!=="context-menu"),ie=Le();n.useEffect(()=>{if(p||(_.current=null),S.type==="context-menu"){if(!p){ie.clear(),ae.current=!1;return}ie.start(500,()=>{ae.current=!0})}},[ie,p,S.type]),Ht(p&&w&&V!==fe&&M!=="touch",T),je(()=>{!p&&!B&&t.set("hoverEnabled",!0)},[p,B,t]);const z=n.useRef(!0),ue=Le(),O=le((l,x)=>{const H=x.reason;if(p===l&&x.trigger===G&&V===H||(x.preventUnmountOnClose=()=>{t.set("preventUnmountingOnClose",!0)},!l&&x.trigger==null&&(x.trigger=G??void 0),d==null||d(l,x),x.isCanceled))return;const lt={open:l,nativeEvent:x.event,reason:x.reason,nested:K};j==null||j.emit("openchange",lt);const Q=x.event;if(l===!1&&(Q==null?void 0:Q.type)==="click"&&Q.pointerType==="touch"&&!z.current)return;if(!l&&Y!==null){const te=t.context.itemDomElements.current[Y];queueMicrotask(()=>{te==null||te.setAttribute("tabindex","-1")})}l&&H===Ue?(z.current=!1,ue.start(300,()=>{z.current=!0})):(z.current=!0,ue.clear());const we=(H===vt||H===he)&&Q.detail===0&&(Q==null?void 0:Q.isTrusted),dt=!l&&(H===Ct||H==null);function Oe(){var Ae;const te={open:l,openChangeReason:H};_.current=x.event??null;const Ne=((Ae=x.trigger)==null?void 0:Ae.id)??null;(Ne||l)&&(te.activeTriggerId=Ne,te.activeTriggerElement=x.trigger??null),t.update(te)}H===fe?Xt.flushSync(Oe):Oe(),S.type==="menubar"&&(H===Ue||H===bt||H===fe||H===xt||H===ce)?t.set("instantType","group"):we||dt?t.set("instantType",we?"click":"dismiss"):t.set("instantType",void 0)}),L=n.useCallback(l=>{const x=ne(l);return x.preventUnmountOnClose=()=>{t.set("preventUnmountingOnClose",!0)},x},[t]),pe=n.useCallback(()=>{t.setOpen(!1,L(ht))},[t,L]);n.useImperativeHandle(m,()=>({unmount:se,close:pe}),[se,pe]);let ee;S.type==="context-menu"&&(ee=S.context),n.useImperativeHandle(ee==null?void 0:ee.positionerRef,()=>T,[T]),n.useImperativeHandle(ee==null?void 0:ee.actionsRef,()=>({setOpen:O}),[O]);const re=on({popupStore:t,onOpenChange:O});j=re.context.events,n.useEffect(()=>{const l=({open:x,eventDetails:H})=>O(x,H);return j.on("setOpen",l),()=>{j==null||j.off("setOpen",l)}},[j,O]);const Qe=Wt(re,{enabled:!k,bubbles:{escapeKey:v&&S.type==="menu"},outsidePress(){var l;return S.type!=="context-menu"||((l=_.current)==null?void 0:l.type)==="contextmenu"?!0:ae.current},externalTree:K?U:void 0}),Ze=rn(re,{role:"menu"}),et=zt(),tt=n.useCallback(l=>{t.select("activeIndex")!==l&&t.set("activeIndex",l)},[t]),nt=an(re,{enabled:!k,listRef:t.context.itemDomElements,activeIndex:Y,nested:S.type!==void 0,loopFocus:c,orientation:h,parentOrientation:S.type==="menubar"?S.context.orientation:void 0,rtl:et==="rtl",disabledIndices:yt,onNavigate:tt,openOnArrowKeyDown:S.type!=="context-menu",externalTree:K?U:void 0,focusItemOnHover:a}),ot=n.useCallback(l=>{t.context.typingRef.current=l},[t]),st=un(re,{listRef:t.context.itemLabels,activeIndex:Y,resetMs:Tt,onMatch:l=>{p&&l!==Y&&t.set("activeIndex",l)},onTypingChange:ot}),{getReferenceProps:ye,getFloatingProps:Pe,getItemProps:Se,getTriggerProps:Ee}=_e([Qe,Ze,nt,st]),rt=n.useMemo(()=>{const l=xe(ye(),{onMouseEnter(){t.set("hoverEnabled",!0)},onMouseMove(){t.set("allowMouseEnter",!0)}},Z);return delete l.role,l},[ye,t,Z]),at=n.useMemo(()=>{const l=Ee();if(!l)return l;const x=xe(l,Z);return delete x.role,delete x["aria-controls"],x},[Ee,Z]),Te=$t(),it=n.useMemo(()=>Pe({onMouseEnter(){S.type==="menu"&&Te.request(()=>t.set("hoverEnabled",!1))},onMouseMove(){t.set("allowMouseEnter",!0)},onClick(){t.select("hoverEnabled")&&t.set("hoverEnabled",!1)},onKeyDown(l){const x=t.select("keyboardEventRelay");x&&!l.isPropagationStopped()&&x(l)}}),[Pe,S.type,Te,t]),ut=n.useMemo(()=>Se(),[Se]);t.useSyncedValues({floatingRootContext:re,activeTriggerProps:rt,inactiveTriggerProps:at,popupProps:it,itemProps:ut});const ct=n.useMemo(()=>({store:t,parent:A}),[t,A]),ke=D.jsx(Ye.Provider,{value:ct,children:typeof s=="function"?s({payload:$}):s});return S.type===void 0||S.type==="context-menu"?D.jsx(Jt,{externalTree:U,children:ke}):ke}function vo(e){const s=X().store,u=n.useMemo(()=>({parentMenu:s}),[s]);return D.jsx($e.Provider,{value:u,children:D.jsx(Pn,{...e})})}function Sn(e){if(cn(e)&&e.hasAttribute("data-rootownerid"))return e.getAttribute("data-rootownerid")??void 0;if(!ln(e))return Sn(dn(e))}const bo=n.forwardRef(function(s,u){const{render:d,className:I,label:b,id:E,nativeButton:o=!1,openOnHover:c=!0,delay:h=100,closeDelay:m=0,disabled:v=!1,...f}=s,C=me(),y=de(),{store:a}=X(),g=ge(E),i=a.useState("open"),r=a.useState("floatingRootContext"),N=a.useState("floatingTreeRoot"),A=sn(g,a),t=n.useCallback(q=>{const se=A(q);return q!==null&&a.select("open")&&a.select("activeTriggerId")==null&&a.update({activeTriggerId:g,activeTriggerElement:q,closeDelay:m}),se},[A,m,a,g]),U=n.useRef(null),R=n.useCallback(q=>{U.current=q,a.set("activeTriggerElement",q)},[a]),P=ze();if(!(P!=null&&P.parentMenu))throw new Error(J(37));a.useSyncedValue("closeDelay",m);const p=P.parentMenu,G=p.useState("itemProps"),T=p.useState("isActive",C.index),B=n.useMemo(()=>({type:"submenu-trigger",setActive:()=>p.set("activeIndex",C.index)}),[p,C.index]),w=a.useState("disabled"),k=v||w,{getItemProps:V,itemRef:S}=ve({closeOnClick:!1,disabled:k,highlighted:T,id:g,store:a,nativeButton:o,itemMetadata:B,nodeId:y==null?void 0:y.nodeId}),Y=a.useState("hoverEnabled"),$=a.useState("allowMouseEnter"),oe=Ut(r,{enabled:Y&&c&&!k&&$,handleClose:fn({blockPointerEvents:!0}),mouseOnly:!0,move:!0,restMs:h,delay:{open:h,close:m},triggerElementRef:U,externalTree:N}),_=mn(r,{enabled:!k,event:"mousedown",toggle:!c,ignoreMouse:c,stickIfOpen:!1}),K=_e([_]),j=a.useState("triggerProps",!0);delete j.id;const M=n.useMemo(()=>({disabled:k,highlighted:T,open:i}),[k,T,i]);return W("div",s,{state:M,stateAttributesMapping:kt,props:[K.getReferenceProps(),oe,j,G,{tabIndex:i||T?0:-1,onBlur(){T&&p.set("activeIndex",null)}},f,V],ref:[u,C.ref,S,t,R]})});export{gn as C,Pn as M,po as a,fo as b,lo as c,co as d,io as e,uo as f,mo as g,go as h,ho as i,vo as j,bo as k,Sn as l,Re as m,Mn as n,Rn as o,Ye as p,X as u};
