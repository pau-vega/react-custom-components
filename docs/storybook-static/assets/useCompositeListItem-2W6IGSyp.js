import{r as n}from"./index-Br2IOmUs.js";import{u as I}from"./useIsoLayoutEffect-B3i3ZXBb.js";const F=n.createContext({register:()=>{},unregister:()=>{},subscribeMapChange:()=>()=>{},elementsRef:{current:[]},nextIndexRef:{current:0}});function M(){return n.useContext(F)}let O=(function(t){return t[t.None=0]="None",t[t.GuessFromOrder=1]="GuessFromOrder",t})({});function k(t={}){const{label:f,metadata:d,textRef:o,indexGuessBehavior:L,index:u}=t,{register:x,unregister:m,subscribeMapChange:C,elementsRef:p,labelsRef:l,nextIndexRef:b}=M(),a=n.useRef(-1),[r,R]=n.useState(u??(L===O.GuessFromOrder?()=>{if(a.current===-1){const e=b.current;b.current+=1,a.current=e}return a.current}:-1)),c=n.useRef(null),g=n.useCallback(e=>{var s;if(c.current=e,r!==-1&&e!==null&&(p.current[r]=e,l)){const i=f!==void 0;l.current[r]=i?f:((s=o==null?void 0:o.current)==null?void 0:s.textContent)??e.textContent}},[r,p,l,f,o]);return I(()=>{if(u!=null)return;const e=c.current;if(e)return x(e,d),()=>{m(e)}},[u,x,m,d]),I(()=>{if(u==null)return C(e=>{var i;const s=c.current?(i=e.get(c.current))==null?void 0:i.index:null;s!=null&&R(s)})},[u,C,R]),n.useMemo(()=>({ref:g,index:r}),[r,g])}export{F as C,O as I,k as u};
