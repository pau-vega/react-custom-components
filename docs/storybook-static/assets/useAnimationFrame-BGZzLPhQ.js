var h=Object.defineProperty;var d=(c,t,s)=>t in c?h(c,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):c[t]=s;var e=(c,t,s)=>d(c,typeof t!="symbol"?t+"":t,s);import{u as o}from"./empty-BwNtW-GQ.js";import{u as f}from"./useOnMount-J4hPCZ9b.js";const n=null;class I{constructor(){e(this,"callbacks",[]);e(this,"callbacksCount",0);e(this,"nextId",1);e(this,"startId",1);e(this,"isScheduled",!1);e(this,"tick",t=>{var u;this.isScheduled=!1;const s=this.callbacks,l=this.callbacksCount;if(this.callbacks=[],this.callbacksCount=0,this.startId=this.nextId,l>0)for(let a=0;a<s.length;a+=1)(u=s[a])==null||u.call(s,t)})}request(t){const s=this.nextId;return this.nextId+=1,this.callbacks.push(t),this.callbacksCount+=1,(!this.isScheduled||!1)&&(requestAnimationFrame(this.tick),this.isScheduled=!0),s}cancel(t){const s=t-this.startId;s<0||s>=this.callbacks.length||(this.callbacks[s]=null,this.callbacksCount-=1)}}const i=new I;class r{constructor(){e(this,"currentId",n);e(this,"cancel",()=>{this.currentId!==n&&(i.cancel(this.currentId),this.currentId=n)});e(this,"disposeEffect",()=>this.cancel)}static create(){return new r}static request(t){return i.request(t)}static cancel(t){return i.cancel(t)}request(t){this.cancel(),this.currentId=i.request(()=>{this.currentId=n,t()})}}function C(){const c=o(r.create).current;return f(c.disposeEffect),c}export{r as A,C as u};
