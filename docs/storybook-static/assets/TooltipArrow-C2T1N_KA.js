var re=Object.defineProperty;var ie=(n,e,o)=>e in n?re(n,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[e]=o;var $=(n,e,o)=>ie(n,typeof e!="symbol"?e+"":e,o);import{r as s}from"./index-Br2IOmUs.js";import{u as E}from"./useIsoLayoutEffect-B3i3ZXBb.js";import{c as W,n as Q,b as q,a as ae,t as ue,e as le,m as ce,p as pe}from"./createBaseUIEventDetails-BfRHIGKf.js";import{r as fe}from"./index-B1jiiJTD.js";import{f as B,u as de}from"./empty-BwNtW-GQ.js";import{p as ge,c as me,d as he,a as ye,b as Ce,u as Se}from"./useSyncedFloatingRootContext-BHS4UzMP.js";import{R as Re,P as Pe,f as O,l as Te,b as ve}from"./useInteractions-DLoJm_bm.js";import{j as F}from"./jsx-runtime-D_zvdyIk.js";import{u as xe}from"./useFocus-Dd2F9aQQ.js";import{g as be}from"./floating-ui.utils.dom-BR__G8pa.js";import{u as z}from"./useStableCallback-CgA2ffE5.js";import{i as Ie}from"./event-D_tFMKDJ.js";import{e as we,d as Me}from"./element-vmEcGomw.js";import{t as Oe,n as Ee,k as G}from"./popupStateMapping-B2J1S55N.js";import{u as N}from"./useRenderElement-DBf0zvZM.js";import{u as Ae}from"./useBaseUiId-Ds3dA0Bv.js";import{u as De,T as ke}from"./useTimeout-DEENwbcq.js";import{g as He,s as Ve}from"./safePolygon-B1_E0Dln.js";import{u as Ue,a as Fe}from"./useHoverReferenceInteraction-BCD5gqBx.js";import{F as Le}from"./FloatingPortalLite-Boq3ScPJ.js";import{u as je,a as Be,g as Z}from"./getDisabledMountTransitionStyles-xn1qLHjW.js";import{a as Ne,t as Xe}from"./useTransitionStatus-H-zITwNf.js";const ee=s.createContext({hasProvider:!1,timeoutMs:0,delayRef:{current:0},initialDelayRef:{current:0},timeout:new ke,currentIdRef:{current:null},currentContextRef:{current:null}});function vt(n){const{children:e,delay:o,timeoutMs:u=0}=n,f=s.useRef(o),r=s.useRef(o),l=s.useRef(null),a=s.useRef(null),d=De();return F.jsx(ee.Provider,{value:s.useMemo(()=>({hasProvider:!0,delayRef:f,initialDelayRef:r,currentIdRef:l,timeoutMs:u,currentContextRef:a,timeout:d}),[u,d]),children:e})}function Ye(n,e={open:!1}){const o="rootStore"in n?n.rootStore:n,u=o.useState("floatingId"),{enabled:f=!0,open:r}=e,l=s.useContext(ee),{currentIdRef:a,delayRef:d,timeoutMs:c,initialDelayRef:p,currentContextRef:i,hasProvider:g,timeout:t}=l,[S,P]=s.useState(!1);return E(()=>{function m(){var C;P(!1),(C=i.current)==null||C.setIsInstantPhase(!1),a.current=null,i.current=null,d.current=p.current}if(f&&a.current&&!r&&a.current===u){if(P(!1),c){const C=u;return t.start(c,()=>{o.select("open")||a.current&&a.current!==C||m()}),()=>{t.clear()}}m()}},[f,r,u,a,d,c,p,i,t,o]),E(()=>{if(!f||!r)return;const m=i.current,C=a.current;t.clear(),i.current={onOpenChange:o.setOpen,setIsInstantPhase:P},a.current=u,d.current={open:0,close:He(p.current,"close")},C!==null&&C!==u?(P(!0),m==null||m.setIsInstantPhase(!0),m==null||m.onOpenChange(!1,W(Q))):(P(!1),m==null||m.setIsInstantPhase(!1))},[f,r,u,o,a,d,c,p,i,t]),E(()=>()=>{i.current=null},[i]),s.useMemo(()=>({hasProvider:g,delayRef:d,isInstantPhase:S}),[g,d,S])}function We(n,e){let o=null,u=null,f=!1;return{contextElement:n||void 0,getBoundingClientRect(){var t;const r=(n==null?void 0:n.getBoundingClientRect())||{width:0,height:0,x:0,y:0},l=e.axis==="x"||e.axis==="both",a=e.axis==="y"||e.axis==="both",d=["mouseenter","mousemove"].includes(((t=e.dataRef.current.openEvent)==null?void 0:t.type)||"")&&e.pointerType!=="touch";let c=r.width,p=r.height,i=r.x,g=r.y;return o==null&&e.x&&l&&(o=r.x-e.x),u==null&&e.y&&a&&(u=r.y-e.y),i-=o||0,g-=u||0,c=0,p=0,!f||d?(c=e.axis==="y"?r.width:0,p=e.axis==="x"?r.height:0,i=l&&e.x!=null?e.x:i,g=a&&e.y!=null?e.y:g):f&&!d&&(p=e.axis==="x"?r.height:p,c=e.axis==="y"?r.width:c),f=!0,{width:c,height:p,x:i,y:g,top:g,right:i+c,bottom:g+p,left:i}}}}function J(n){return n!=null&&n.clientX!=null}function Ge(n,e={}){const o="rootStore"in n?n.rootStore:n,u=o.useState("open"),f=o.useState("floatingElement"),r=o.useState("domReferenceElement"),l=o.context.dataRef,{enabled:a=!0,axis:d="both",x:c=null,y:p=null}=e,i=s.useRef(!1),g=s.useRef(null),[t,S]=s.useState(),[P,m]=s.useState([]),C=z((y,R,T)=>{i.current||l.current.openEvent&&!J(l.current.openEvent)||o.set("positionReference",We(T??r,{x:y,y:R,axis:d,dataRef:l,pointerType:t}))}),h=z(y=>{c!=null||p!=null||(u?g.current||m([]):C(y.clientX,y.clientY,y.currentTarget))}),x=Ie(t)?f:u,b=s.useCallback(()=>{if(!x||!a||c!=null||p!=null)return;const y=be(f);function R(T){const w=we(T);Me(f,w)?(y.removeEventListener("mousemove",R),g.current=null):C(T.clientX,T.clientY)}if(!l.current.openEvent||J(l.current.openEvent)){y.addEventListener("mousemove",R);const T=()=>{y.removeEventListener("mousemove",R),g.current=null};return g.current=T,T}o.set("positionReference",r)},[x,a,c,p,f,l,r,o,C]);s.useEffect(()=>b(),[b,P]),s.useEffect(()=>{a&&!f&&(i.current=!1)},[a,f]),s.useEffect(()=>{!a&&u&&(i.current=!0)},[a,u]),E(()=>{a&&(c!=null||p!=null)&&(i.current=!1,C(c,p))},[a,c,p,C]);const I=s.useMemo(()=>{function y(R){S(R.pointerType)}return{onPointerDown:y,onPointerEnter:y,onMouseMove:h,onMouseEnter:h}},[h]);return s.useMemo(()=>a?{reference:I,trigger:I}:{},[a,I])}const te=s.createContext(void 0);function L(n){const e=s.useContext(te);if(e===void 0&&!n)throw new Error(B(72));return e}const _e={...ge,disabled:O(n=>n.disabled),instantType:O(n=>n.instantType),isInstantPhase:O(n=>n.isInstantPhase),trackCursorAxis:O(n=>n.trackCursorAxis),disableHoverablePopup:O(n=>n.disableHoverablePopup),lastOpenChangeReason:O(n=>n.openChangeReason),closeDelay:O(n=>n.closeDelay),hasViewport:O(n=>n.hasViewport)};class _ extends Re{constructor(o){super({...Ke(),...o},{popupRef:s.createRef(),onOpenChange:void 0,onOpenChangeComplete:void 0,triggerElements:new Pe},_e);$(this,"setOpen",(o,u)=>{var c,p;const f=u.reason,r=f===q,l=o&&f===ae,a=!o&&(f===ue||f===le);if(u.preventUnmountOnClose=()=>{this.set("preventUnmountingOnClose",!0)},(p=(c=this.context).onOpenChange)==null||p.call(c,o,u),u.isCanceled)return;const d=()=>{var t;const i={open:o,openChangeReason:f};l?i.instantType="focus":a?i.instantType="dismiss":f===q&&(i.instantType=void 0);const g=((t=u.trigger)==null?void 0:t.id)??null;(g||o)&&(i.activeTriggerId=g,i.activeTriggerElement=u.trigger??null),this.update(i)};r?fe.flushSync(d):d()})}static useStore(o,u){const f=de(()=>new _(u)).current,r=o??f,l=me({popupStore:r,onOpenChange:r.setOpen});return r.state.floatingRootContext=l,r}}function Ke(){return{...he(),disabled:!1,instantType:void 0,isInstantPhase:!1,trackCursorAxis:"none",disableHoverablePopup:!1,openChangeReason:null,closeDelay:0,hasViewport:!1}}function xt(n){const{disabled:e=!1,defaultOpen:o=!1,open:u,disableHoverablePopup:f=!1,trackCursorAxis:r="none",actionsRef:l,onOpenChange:a,onOpenChangeComplete:d,handle:c,triggerId:p,defaultTriggerId:i=null,children:g}=n,t=_.useStore(c==null?void 0:c.store,{open:u??o,activeTriggerId:p!==void 0?p:i});t.useControlledProp("open",u,o),t.useControlledProp("activeTriggerId",p,i),t.useContextCallback("onOpenChange",a),t.useContextCallback("onOpenChangeComplete",d);const S=t.useState("open"),P=!e&&S,m=t.useState("activeTriggerId"),C=t.useState("payload");t.useSyncedValues({trackCursorAxis:r,disableHoverablePopup:f}),E(()=>{S&&e&&t.setOpen(!1,W(pe))},[S,e,t]),t.useSyncedValue("disabled",e),ye(t);const{forceUnmount:h,transitionStatus:x}=Ce(P,t),b=t.useState("isInstantPhase"),I=t.useState("instantType"),y=t.useState("lastOpenChangeReason"),R=s.useRef(null);E(()=>{x==="ending"&&y===Q||x!=="ending"&&b?(I!=="delay"&&(R.current=I),t.set("instantType","delay")):R.current!==null&&(t.set("instantType",R.current),R.current=null)},[x,b,y,I,t]),E(()=>{P&&m==null&&t.set("payload",void 0)},[t,m,P]);const T=s.useCallback(()=>{t.setOpen(!1,$e(t,ce))},[t]);s.useImperativeHandle(l,()=>({unmount:h,close:T}),[h,T]);const w=t.useState("floatingRootContext"),A=xe(w,{enabled:!e}),V=Te(w,{enabled:!e,referencePress:!0}),v=Ge(w,{enabled:!e&&r!=="none",axis:r==="none"?void 0:r}),{getReferenceProps:D,getFloatingProps:M,getTriggerProps:k}=ve([A,V,v]),U=s.useMemo(()=>D(),[D]),H=s.useMemo(()=>k(),[k]),K=s.useMemo(()=>M(),[M]);return t.useSyncedValues({activeTriggerProps:U,inactiveTriggerProps:H,popupProps:K}),F.jsx(te.Provider,{value:t,children:typeof g=="function"?g({payload:C}):g})}function $e(n,e){const o=W(e);return o.preventUnmountOnClose=()=>{n.set("preventUnmountingOnClose",!0)},o}const qe=s.createContext(void 0);function ze(){return s.useContext(qe)}const Je=600,bt=s.forwardRef(function(e,o){const{className:u,render:f,handle:r,payload:l,disabled:a,delay:d,closeDelay:c,id:p,...i}=e,g=L(!0),t=(r==null?void 0:r.store)??g;if(!t)throw new Error(B(82));const S=Ae(p),P=t.useState("isTriggerActive",S),m=t.useState("isOpenedByTrigger",S),C=t.useState("floatingRootContext"),h=s.useRef(null),x=d??Je,b=c??0,{registerTrigger:I,isMountedByThisTrigger:y}=Se(S,h,t,{payload:l,closeDelay:b}),R=ze(),{delayRef:T,isInstantPhase:w,hasProvider:A}=Ye(C,{open:m});t.useSyncedValue("isInstantPhase",w);const V=t.useState("disabled"),v=a??V,D=t.useState("trackCursorAxis"),M=t.useState("disableHoverablePopup"),k=Ue(C,{enabled:!v,mouseOnly:!0,move:!1,handleClose:!M&&D!=="both"?Ve():null,restMs(){const X=R==null?void 0:R.delay,j=typeof T.current=="object"?T.current.open:void 0;let Y=x;return A&&(j!==0?Y=d??X??x:Y=0),Y},delay(){const X=typeof T.current=="object"?T.current.close:void 0;let j=b;return c==null&&A&&(j=X),{close:j}},triggerElementRef:h,isActiveTrigger:P}),U=s.useMemo(()=>({open:m}),[m]),H=t.useState("triggerProps",y);return N("button",e,{state:U,ref:[o,I,h],props:[k,H,{id:S},i],stateAttributesMapping:Oe})}),ne=s.createContext(void 0);function Qe(){const n=s.useContext(ne);if(n===void 0)throw new Error(B(70));return n}const It=s.forwardRef(function(e,o){const{keepMounted:u=!1,...f}=e;return L().useState("mounted")||u?F.jsx(ne.Provider,{value:u,children:F.jsx(Le,{ref:o,...f})}):null}),oe=s.createContext(void 0);function se(){const n=s.useContext(oe);if(n===void 0)throw new Error(B(71));return n}const wt=s.forwardRef(function(e,o){const{render:u,className:f,anchor:r,positionMethod:l="absolute",side:a="top",align:d="center",sideOffset:c=0,alignOffset:p=0,collisionBoundary:i="clipping-ancestors",collisionPadding:g=5,arrowPadding:t=5,sticky:S=!1,disableAnchorTracking:P=!1,collisionAvoidance:m=Ee,...C}=e,h=L(),x=Qe(),b=h.useState("open"),I=h.useState("mounted"),y=h.useState("trackCursorAxis"),R=h.useState("disableHoverablePopup"),T=h.useState("floatingRootContext"),w=h.useState("instantType"),A=h.useState("transitionStatus"),V=h.useState("hasViewport"),v=je({anchor:r,positionMethod:l,floatingRootContext:T,mounted:I,side:a,sideOffset:c,align:d,alignOffset:p,collisionBoundary:i,collisionPadding:g,sticky:S,arrowPadding:t,disableAnchorTracking:P,keepMounted:x,collisionAvoidance:m,adaptiveOrigin:V?Be:void 0}),D=s.useMemo(()=>{const H={};return(!b||y==="both"||R)&&(H.pointerEvents="none"),{role:"presentation",hidden:!I,style:{...v.positionerStyles,...H}}},[b,y,R,I,v.positionerStyles]),M=s.useMemo(()=>({open:b,side:v.side,align:v.align,anchorHidden:v.anchorHidden,instant:y!=="none"?"tracking-cursor":w}),[b,v.side,v.align,v.anchorHidden,y,w]),k=s.useMemo(()=>({...M,arrowRef:v.arrowRef,arrowStyles:v.arrowStyles,arrowUncentered:v.arrowUncentered}),[M,v.arrowRef,v.arrowStyles,v.arrowUncentered]),U=N("div",e,{state:M,props:[D,Z(A),C],ref:[o,h.useStateSetter("positionerElement")],stateAttributesMapping:G});return F.jsx(oe.Provider,{value:k,children:U})}),Ze={...G,...Xe},Mt=s.forwardRef(function(e,o){const{className:u,render:f,...r}=e,l=L(),{side:a,align:d}=se(),c=l.useState("open"),p=l.useState("instantType"),i=l.useState("transitionStatus"),g=l.useState("popupProps"),t=l.useState("floatingRootContext");Ne({open:c,ref:l.context.popupRef,onComplete(){var h,x;c&&((x=(h=l.context).onOpenChangeComplete)==null||x.call(h,!0))}});const S=l.useState("disabled"),P=l.useState("closeDelay");Fe(t,{enabled:!S,closeDelay:P});const m=s.useMemo(()=>({open:c,side:a,align:d,instant:p,transitionStatus:i}),[c,a,d,p,i]);return N("div",e,{state:m,ref:[o,l.context.popupRef,l.useStateSetter("popupElement")],props:[g,Z(i),r],stateAttributesMapping:Ze})}),Ot=s.forwardRef(function(e,o){const{className:u,render:f,...r}=e,a=L().useState("instantType"),{open:d,arrowRef:c,side:p,align:i,arrowUncentered:g,arrowStyles:t}=se(),S=s.useMemo(()=>({open:d,side:p,align:i,uncentered:g,instant:a}),[d,p,i,g,a]);return N("div",e,{state:S,ref:[o,c],props:[{style:t,"aria-hidden":!0},r],stateAttributesMapping:G})});export{vt as F,xt as T,It as a,wt as b,Mt as c,Ot as d,bt as e,qe as f};
