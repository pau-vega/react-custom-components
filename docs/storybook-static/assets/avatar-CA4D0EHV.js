import{t as L,c as w}from"./bundle-mjs-BNe0Xlio.js";import{j as m}from"./jsx-runtime-D_zvdyIk.js";import{r as s}from"./index-Br2IOmUs.js";import{u as g}from"./useRenderElement-DBf0zvZM.js";import{f as z,N as R}from"./empty-BwNtW-GQ.js";import{u as j}from"./useStableCallback-CgA2ffE5.js";import{u as A}from"./useIsoLayoutEffect-B3i3ZXBb.js";import{u as k}from"./useTimeout-DEENwbcq.js";const S=s.createContext(void 0);function M(){const e=s.useContext(S);if(e===void 0)throw new Error(z(13));return e}const p={imageLoadingStatus:()=>null},I=s.forwardRef(function(t,u){const{className:c,render:l,...r}=t,[a,n]=s.useState("idle"),i=s.useMemo(()=>({imageLoadingStatus:a}),[a]),d=s.useMemo(()=>({imageLoadingStatus:a,setImageLoadingStatus:n}),[a,n]),o=g("span",t,{state:i,ref:u,props:r,stateAttributesMapping:p});return m.jsx(S.Provider,{value:d,children:o})});function N(e,{referrerPolicy:t,crossOrigin:u}){const[c,l]=s.useState("idle");return A(()=>{if(!e)return l("error"),R;let r=!0;const a=new window.Image,n=i=>()=>{r&&l(i)};return l("loading"),a.onload=n("loaded"),a.onerror=n("error"),t&&(a.referrerPolicy=t),a.crossOrigin=u??null,a.src=e,()=>{r=!1}},[e,u,t]),c}const E=s.forwardRef(function(t,u){const{className:c,render:l,onLoadingStatusChange:r,referrerPolicy:a,crossOrigin:n,...i}=t,d=M(),o=N(t.src,{referrerPolicy:a,crossOrigin:n}),f=j(b=>{r==null||r(b),d.setImageLoadingStatus(b)});A(()=>{o!=="idle"&&f(o)},[o,f]);const x=s.useMemo(()=>({imageLoadingStatus:o}),[o]);return g("img",t,{state:x,ref:u,props:i,stateAttributesMapping:p,enabled:o==="loaded"})}),h=s.forwardRef(function(t,u){const{className:c,render:l,delay:r,...a}=t,{imageLoadingStatus:n}=M(),[i,d]=s.useState(r===void 0),o=k();s.useEffect(()=>(r!==void 0&&o.start(r,()=>d(!0)),o.clear),[o,r]);const f=s.useMemo(()=>({imageLoadingStatus:n}),[n]);return g("span",t,{state:f,ref:u,props:a,stateAttributesMapping:p,enabled:n!=="loaded"&&i})});function v(...e){return L(w(e))}function V({className:e,size:t="default",...u}){return m.jsx(I,{"data-slot":"avatar","data-size":t,className:v("size-8 rounded-full after:rounded-full data-[size=lg]:size-10 data-[size=sm]:size-6 after:border-border group/avatar relative flex shrink-0 select-none after:absolute after:inset-0 after:border after:mix-blend-darken dark:after:mix-blend-lighten",e),...u})}function B({className:e,...t}){return m.jsx(E,{"data-slot":"avatar-image",className:v("rounded-full aspect-square size-full object-cover",e),...t})}function G({className:e,...t}){return m.jsx(h,{"data-slot":"avatar-fallback",className:v("bg-muted text-muted-foreground rounded-full flex size-full items-center justify-center text-sm group-data-[size=sm]/avatar:text-xs",e),...t})}export{V as A,B as a,G as b};
