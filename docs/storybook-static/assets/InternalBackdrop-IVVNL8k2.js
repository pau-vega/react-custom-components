var st=Object.defineProperty;var it=(e,r,n)=>r in e?st(e,r,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[r]=n;var X=(e,r,n)=>it(e,typeof r!="symbol"?r+"":r,n);import{r as R}from"./index-Br2IOmUs.js";import{c as ct,d as Ke,e as Ee,F as Me,i as Ge,b as ut,f as lt,h as Ue,C as at,j as ft}from"./popupStateMapping-B2J1S55N.js";import{c as _e,a as Z,g as fe,d as dt,e as Je}from"./floating-ui.utils.dom-BR__G8pa.js";import{b as Ce,N as bt}from"./empty-BwNtW-GQ.js";import{u as se}from"./useValueAsRef-uCcb0GiG.js";import{u as ie}from"./useStableCallback-CgA2ffE5.js";import{u as te}from"./useIsoLayoutEffect-B3i3ZXBb.js";import{v as mt}from"./visuallyHidden-BwafneL2.js";import{u as Ne,T as We}from"./useTimeout-DEENwbcq.js";import{u as pt,A as ht}from"./useAnimationFrame-BGZzLPhQ.js";import{b as vt,o as gt,c as yt,f as Et}from"./createBaseUIEventDetails-BfRHIGKf.js";import{a as wt,c as Be,j as Pe,g as Ve}from"./useInteractions-DLoJm_bm.js";import{e as ve}from"./useOpenInteractionType-DABt_JZJ.js";import{c as Y,a as Ye,g as De,b as ee,d as T,e as ce}from"./element-vmEcGomw.js";import{r as j}from"./useTransitionStatus-H-zITwNf.js";import{j as ae}from"./jsx-runtime-D_zvdyIk.js";import{b as Rt,c as kt,s as St}from"./event-D_tFMKDJ.js";import{d as Ft,e as Tt}from"./detectBrowser-Cp-v3zjv.js";import{o as ne}from"./owner-CQsS7OFZ.js";const K={inert:new WeakMap,"aria-hidden":new WeakMap,none:new WeakMap};function je(e){return e==="inert"?K.inert:e==="aria-hidden"?K["aria-hidden"]:K.none}let ue=new WeakSet,le={},ge=0;const Qe=e=>e&&(e.host||Qe(e.parentNode)),Lt=(e,r)=>r.map(n=>{if(e.contains(n))return n;const t=Qe(n);return e.contains(t)?t:null}).filter(n=>n!=null);function Ot(e,r,n,t){const f="data-base-ui-inert",d=t?"inert":n?"aria-hidden":null,v=Lt(r,e),k=new Set,E=new Set(v),O=[];le[f]||(le[f]=new WeakMap);const N=le[f];v.forEach(q),I(r),k.clear();function q(b){!b||k.has(b)||(k.add(b),b.parentNode&&q(b.parentNode))}function I(b){!b||E.has(b)||[].forEach.call(b.children,g=>{if(_e(g)!=="script")if(k.has(g))I(g);else{const z=d?g.getAttribute(d):null,S=z!==null&&z!=="false",w=je(d),p=(w.get(g)||0)+1,h=(N.get(g)||0)+1;w.set(g,p),N.set(g,h),O.push(g),p===1&&S&&ue.add(g),h===1&&g.setAttribute(f,""),!S&&d&&g.setAttribute(d,d==="inert"?"":"true")}})}return ge+=1,()=>{O.forEach(b=>{const g=je(d),S=(g.get(b)||0)-1,w=(N.get(b)||0)-1;g.set(b,S),N.set(b,w),S||(!ue.has(b)&&d&&b.removeAttribute(d),ue.delete(b)),w||b.removeAttribute(f)}),ge-=1,ge||(K.inert=new WeakMap,K["aria-hidden"]=new WeakMap,K.none=new WeakMap,ue=new WeakSet,le={})}}function It(e,r=!1,n=!1){const t=Y(e[0]).body;return Ot(e.concat(Array.from(t.querySelectorAll("[aria-live]"))),t,r,n)}function xt(e,r){const n=fe(e.target);return e instanceof n.KeyboardEvent?"keyboard":e instanceof n.FocusEvent?r||"keyboard":"pointerType"in e?e.pointerType||"keyboard":"touches"in e?"touch":e instanceof n.MouseEvent?r||(e.detail===0?"keyboard":"mouse"):""}const $e=20;let $=[];function we(){$=$.filter(e=>e.isConnected)}function At(e){we(),e&&_e(e)!=="body"&&($.push(e),$.length>$e&&($=$.slice(-$e)))}function ye(){return we(),$[$.length-1]}function Mt(e){if(!e)return null;const r=Ee();return Ue(e,r)?e:Ke(e,r)[0]||e}function Gt(e){return!e||!e.isConnected?!1:typeof e.checkVisibility=="function"?e.checkVisibility():dt(e).display!=="none"}function qe(e,r){var v;if(!r.current.includes("floating")&&!((v=e.getAttribute("role"))!=null&&v.includes("dialog")))return;const n=Ee(),f=ft(e,n).filter(k=>{const E=k.getAttribute("data-tabindex")||"";return Ue(k,n)||k.hasAttribute("data-tabindex")&&!E.startsWith("-")}),d=e.getAttribute("tabindex");r.current.includes("floating")||f.length===0?d!=="0"&&e.setAttribute("tabindex","0"):(d!=="-1"||e.hasAttribute("data-tabindex")&&e.getAttribute("data-tabindex")!=="-1")&&(e.setAttribute("tabindex","-1"),e.setAttribute("data-tabindex","-1"))}function cn(e){const{context:r,children:n,disabled:t=!1,order:f=["content"],initialFocus:d=!0,returnFocus:v=!0,restoreFocus:k=!1,modal:E=!0,closeOnFocusOut:O=!0,openInteractionType:N="",getInsideElements:q=()=>[],nextFocusableElement:I,previousFocusableElement:b,beforeContentFocusGuardRef:g,externalTree:z}=e,S="rootStore"in r?r.rootStore:r,w=S.useState("open"),p=S.useState("domReferenceElement"),h=S.useState("floatingElement"),{events:U,dataRef:W}=S.context,B=ie(()=>{var s;return(s=W.current.floatingContext)==null?void 0:s.nodeId}),_=ie(q),J=d===!1,L=Ye(p)&&J,x=se(f),Re=se(d),re=se(v),ke=se(N),A=wt(z),o=ct(),Ze=R.useRef(null),et=R.useRef(null),M=R.useRef(!1),oe=R.useRef(!1),de=R.useRef(!1),Se=R.useRef(-1),Fe=R.useRef(""),be=R.useRef(""),me=R.useRef(null),pe=R.useRef(null),tt=Ce(me,g,o==null?void 0:o.beforeInsideRef),nt=Ce(pe,o==null?void 0:o.afterInsideRef),Te=Ne(),Le=Ne(),Oe=pt(),he=o!=null,u=De(h),H=ie((s=u)=>s?Ke(s,Ee()):[]),Q=ie(s=>{const a=H(s);return x.current.map(()=>a).filter(Boolean).flat()});R.useEffect(()=>{if(t||!E)return;function s(l){l.key==="Tab"&&T(u,ee(Y(u)))&&H().length===0&&!L&&St(l)}const a=Y(u);return a.addEventListener("keydown",s),()=>{a.removeEventListener("keydown",s)}},[t,p,u,E,x,L,H,Q]),R.useEffect(()=>{if(t||!h)return;function s(a){const l=ce(a),y=H().indexOf(l);y!==-1&&(Se.current=y)}return h.addEventListener("focusin",s),()=>{h.removeEventListener("focusin",s)}},[t,h,H]),R.useEffect(()=>{if(t||!w)return;const s=Y(u);function a(){de.current=!1}function l(y){const i=ce(y),c=T(h,i)||T(p,i)||T(o==null?void 0:o.portalNode,i);de.current=!c,be.current=y.pointerType||"keyboard"}function m(){be.current="keyboard"}return s.addEventListener("pointerdown",l,!0),s.addEventListener("pointerup",a,!0),s.addEventListener("pointercancel",a,!0),s.addEventListener("keydown",m,!0),()=>{s.removeEventListener("pointerdown",l,!0),s.removeEventListener("pointerup",a,!0),s.removeEventListener("pointercancel",a,!0),s.removeEventListener("keydown",m,!0)}},[t,h,p,u,w,o]),R.useEffect(()=>{if(t||!O)return;function s(){oe.current=!0,Le.start(0,()=>{oe.current=!1})}function a(i){const c=i.relatedTarget,P=i.currentTarget,F=ce(i);queueMicrotask(()=>{const G=B(),xe=S.context.triggerElements,rt=(c==null?void 0:c.hasAttribute(Be("focus-guard")))&&[me.current,pe.current,o==null?void 0:o.beforeInsideRef.current,o==null?void 0:o.afterInsideRef.current,o==null?void 0:o.beforeOutsideRef.current,o==null?void 0:o.afterOutsideRef.current,j(b),j(I)].includes(c),ot=!(T(p,c)||T(h,c)||T(c,h)||T(o==null?void 0:o.portalNode,c)||c!=null&&xe.hasElement(c)||xe.hasMatchingElement(C=>T(C,c))||rt||A&&(Ve(A.nodesRef.current,G).find(C=>{var V,D;return T((V=C.context)==null?void 0:V.elements.floating,c)||T((D=C.context)==null?void 0:D.elements.domReference,c)})||Pe(A.nodesRef.current,G).find(C=>{var V,D,Ae;return[(V=C.context)==null?void 0:V.elements.floating,De((D=C.context)==null?void 0:D.elements.floating)].includes(c)||((Ae=C.context)==null?void 0:Ae.elements.domReference)===c})));if(P===p&&u&&qe(u,x),k&&P!==p&&!Gt(F)&&ee(Y(u))===Y(u).body){if(Z(u)&&(u.focus(),k==="popup")){Oe.request(()=>{u.focus()});return}const C=Se.current,V=H(),D=V[C]||V[V.length-1]||u;Z(D)&&D.focus()}if(W.current.insideReactTree){W.current.insideReactTree=!1;return}(L||!E)&&c&&ot&&!oe.current&&(L||c!==ye())&&(M.current=!0,S.setOpen(!1,yt(Et,i)))})}function l(){de.current||(W.current.insideReactTree=!0,Te.start(0,()=>{W.current.insideReactTree=!1}))}const m=Z(p)?p:null,y=[];if(!(!h&&!m))return m&&(m.addEventListener("focusout",a),m.addEventListener("pointerdown",s),y.push(()=>{m.removeEventListener("focusout",a),m.removeEventListener("pointerdown",s)})),h&&(h.addEventListener("focusout",a),o&&(h.addEventListener("focusout",l,!0),y.push(()=>{h.removeEventListener("focusout",l,!0)})),y.push(()=>{h.removeEventListener("focusout",a)})),()=>{y.forEach(i=>{i()})}},[t,p,h,u,E,A,o,S,O,k,H,L,B,x,W,Te,Le,Oe,I,b]),R.useEffect(()=>{var i,c,P;if(t||!h||!w)return;const s=Array.from(((i=o==null?void 0:o.portalNode)==null?void 0:i.querySelectorAll(`[${Be("portal")}]`))||[]),l=(P=(c=(A?Pe(A.nodesRef.current,B()):[]).find(F=>{var G;return Ye(((G=F.context)==null?void 0:G.elements.domReference)||null)}))==null?void 0:c.context)==null?void 0:P.elements.domReference,m=[h,l,...s,..._(),Ze.current,et.current,me.current,pe.current,o==null?void 0:o.beforeOutsideRef.current,o==null?void 0:o.afterOutsideRef.current,j(b),j(I),L?p:null].filter(F=>F!=null),y=It(m,E||L);return()=>{y()}},[w,t,p,h,E,x,o,L,A,B,_,I,b]),te(()=>{if(!w||t||!Z(u))return;const s=Y(u),a=ee(s);queueMicrotask(()=>{const l=Q(u),m=Re.current,y=typeof m=="function"?m(ke.current||""):m;if(y===void 0||y===!1)return;let i;y===!0||y===null?i=l[0]||u:i=j(y),i=i||l[0]||u,!T(u,a)&&ve(i,{preventScroll:i===u})})},[t,w,u,J,Q,Re,ke]),te(()=>{if(t||!u)return;const s=Y(u),a=ee(s);At(a);function l(i){if(i.open||(Fe.current=xt(i.nativeEvent,be.current)),i.reason===vt&&i.nativeEvent.type==="mouseleave"&&(M.current=!0),i.reason===gt)if(i.nested)M.current=!1;else if(Rt(i.nativeEvent)||kt(i.nativeEvent))M.current=!1;else{let c=!1;document.createElement("div").focus({get preventScroll(){return c=!0,!1}}),c?M.current=!1:M.current=!0}}U.on("openchange",l);const m=s.createElement("span");m.setAttribute("tabindex","-1"),m.setAttribute("aria-hidden","true"),Object.assign(m.style,mt),he&&p&&p.insertAdjacentElement("afterend",m);function y(){const i=re.current;let c=typeof i=="function"?i(Fe.current):i;if(c===void 0||c===!1)return null;if(c===null&&(c=!0),typeof c=="boolean"){const F=p||ye();return F&&F.isConnected?F:m}const P=p||ye()||m;return j(c)||P}return()=>{U.off("openchange",l);const i=ee(s),c=T(h,i)||A&&Ve(A.nodesRef.current,B(),!1).some(F=>{var G;return T((G=F.context)==null?void 0:G.elements.floating,i)}),P=y();queueMicrotask(()=>{const F=Mt(P),G=typeof re.current!="boolean";re.current&&!M.current&&Z(F)&&(!(!G&&F!==i&&i!==s.body)||c)&&F.focus({preventScroll:!0}),m.remove()})}},[t,h,u,re,W,U,A,he,p,B]),R.useEffect(()=>{queueMicrotask(()=>{M.current=!1})},[t]),R.useEffect(()=>{if(t||!w)return;function s(l){const m=ce(l);m!=null&&m.closest(`[${at}]`)&&(oe.current=!0)}const a=Y(u);return a.addEventListener("pointerdown",s,!0),()=>{a.removeEventListener("pointerdown",s,!0)}},[t,w,u]),te(()=>{if(!t&&o)return o.setFocusManagerState({modal:E,closeOnFocusOut:O,open:w,onOpenChange:S.setOpen,domReference:p}),()=>{o.setFocusManagerState(null)}},[t,o,E,w,S,O,p]),te(()=>{if(!(t||!u))return qe(u,x),()=>{queueMicrotask(we)}},[t,u,x]);const Ie=!t&&(E?!L:!0)&&(he||E);return ae.jsxs(R.Fragment,{children:[Ie&&ae.jsx(Me,{"data-type":"inside",ref:tt,onFocus:s=>{var a;if(E){const l=Q();ve(l[l.length-1])}else if(o!=null&&o.portalNode)if(M.current=!1,Ge(s,o.portalNode)){const l=ut(p);l==null||l.focus()}else(a=j(b??o.beforeOutsideRef))==null||a.focus()}}),n,Ie&&ae.jsx(Me,{"data-type":"inside",ref:nt,onFocus:s=>{var a;if(E)ve(Q()[0]);else if(o!=null&&o.portalNode)if(O&&(M.current=!0),Ge(s,o.portalNode)){const l=lt(p);l==null||l.focus()}else(a=j(I??o.afterOutsideRef))==null||a.focus()}})]})}let He={},Xe={},ze="";function Ct(e){if(typeof document>"u")return!1;const r=ne(e);return fe(r).innerWidth-r.documentElement.clientWidth>0}function Nt(e){if(!(typeof CSS<"u"&&CSS.supports&&CSS.supports("scrollbar-gutter","stable"))||typeof document>"u")return!1;const t=ne(e).documentElement,f={scrollbarGutter:t.style.scrollbarGutter,overflowY:t.style.overflowY};t.style.scrollbarGutter="stable",t.style.overflowY="scroll";const d=t.offsetWidth;t.style.overflowY="hidden";const v=t.offsetWidth;return Object.assign(t.style,f),d===v}function Wt(e){const r=ne(e),n=r.documentElement,t=r.body,f=Je(n)?n:t,d=f.style.overflow;return f.style.overflow="hidden",()=>{f.style.overflow=d}}function Bt(e){var I;const r=ne(e),n=r.documentElement,t=r.body,f=fe(n);let d=0,v=0,k=!1;const E=ht.create();if(Tt&&(((I=f.visualViewport)==null?void 0:I.scale)??1)!==1)return()=>{};function O(){const b=f.getComputedStyle(n),g=f.getComputedStyle(t),w=(b.scrollbarGutter||"").includes("both-edges")?"stable both-edges":"stable";d=n.scrollTop,v=n.scrollLeft,He={scrollbarGutter:n.style.scrollbarGutter,overflowY:n.style.overflowY,overflowX:n.style.overflowX},ze=n.style.scrollBehavior,Xe={position:t.style.position,height:t.style.height,width:t.style.width,boxSizing:t.style.boxSizing,overflowY:t.style.overflowY,overflowX:t.style.overflowX,scrollBehavior:t.style.scrollBehavior};const p=n.scrollHeight>n.clientHeight,h=n.scrollWidth>n.clientWidth,U=b.overflowY==="scroll"||g.overflowY==="scroll",W=b.overflowX==="scroll"||g.overflowX==="scroll",B=Math.max(0,f.innerWidth-t.clientWidth),_=Math.max(0,f.innerHeight-t.clientHeight),J=parseFloat(g.marginTop)+parseFloat(g.marginBottom),L=parseFloat(g.marginLeft)+parseFloat(g.marginRight),x=Je(n)?n:t;if(k=Nt(e),k){n.style.scrollbarGutter=w,x.style.overflowY="hidden",x.style.overflowX="hidden";return}Object.assign(n.style,{scrollbarGutter:w,overflowY:"hidden",overflowX:"hidden"}),(p||U)&&(n.style.overflowY="scroll"),(h||W)&&(n.style.overflowX="scroll"),Object.assign(t.style,{position:"relative",height:J||_?`calc(100dvh - ${J+_}px)`:"100dvh",width:L||B?`calc(100vw - ${L+B}px)`:"100vw",boxSizing:"border-box",overflow:"hidden",scrollBehavior:"unset"}),t.scrollTop=d,t.scrollLeft=v,n.setAttribute("data-base-ui-scroll-locked",""),n.style.scrollBehavior="unset"}function N(){Object.assign(n.style,He),Object.assign(t.style,Xe),k||(n.scrollTop=d,n.scrollLeft=v,n.removeAttribute("data-base-ui-scroll-locked"),n.style.scrollBehavior=ze)}function q(){N(),E.request(O)}return O(),f.addEventListener("resize",q),()=>{E.cancel(),N(),typeof f.removeEventListener=="function"&&f.removeEventListener("resize",q)}}class Pt{constructor(){X(this,"lockCount",0);X(this,"restore",null);X(this,"timeoutLock",We.create());X(this,"timeoutUnlock",We.create());X(this,"release",()=>{this.lockCount-=1,this.lockCount===0&&this.restore&&this.timeoutUnlock.start(0,this.unlock)});X(this,"unlock",()=>{var r;this.lockCount===0&&this.restore&&((r=this.restore)==null||r.call(this),this.restore=null)})}acquire(r){return this.lockCount+=1,this.lockCount===1&&this.restore===null&&this.timeoutLock.start(0,()=>this.lock(r)),this.release}lock(r){if(this.lockCount===0||this.restore!==null)return;const t=ne(r).documentElement,f=fe(t).getComputedStyle(t).overflowY;if(f==="hidden"||f==="clip"){this.restore=bt;return}const d=Ft||!Ct(r);this.restore=d?Wt(r):Bt(r)}}const Vt=new Pt;function un(e=!0,r=null){te(()=>{if(e)return Vt.acquire(r)},[e,r])}const ln=R.forwardRef(function(r,n){const{cutout:t,...f}=r;let d;if(t){const v=t==null?void 0:t.getBoundingClientRect();d=`polygon(
      0% 0%,
      100% 0%,
      100% 100%,
      0% 100%,
      0% 0%,
      ${v.left}px ${v.top}px,
      ${v.left}px ${v.bottom}px,
      ${v.right}px ${v.bottom}px,
      ${v.right}px ${v.top}px,
      ${v.left}px ${v.top}px
    )`}return ae.jsx("div",{ref:n,role:"presentation","data-base-ui-inert":"",...f,style:{position:"fixed",inset:0,userSelect:"none",WebkitUserSelect:"none",clipPath:d}})});export{cn as F,ln as I,un as u};
